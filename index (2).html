import tkinter as tk
import random
import threading
import time
import math

# 存储所有弹窗窗口对象
all_windows = []


def show_warm_tip(x, y):
    window = tk.Tk()
    all_windows.append(window)  # 将窗口加入管理列表

    window.width = 250
    window.height = 60
    # 限制窗口在屏幕内
    screen_width = window.winfo_screenwidth()
    screen_height = window.winfo_screenheight()
    x_pos = max(0, min(int(x - window.width / 2), screen_width - window.width))
    y_pos = max(0, min(int(y - window.height / 2), screen_height - window.height))
    window.title("温馨提示")
    window.geometry(f"{window.width}x{window.height}+{x_pos}+{y_pos}")

    tips = [
        "多喝热水哦", "保持微笑呀", "天天开心",
        "记得吃水果", "保持好心情", "好好爱自己", "我想你了",
        "梦想成真", "期待下一次见面", "我爱你",
        "顺顺利利", "早点休息", "愿所有烦恼都消失",
        "别熬夜", "今天过的开心嘛", "天冷了，多穿衣服"
    ]
    tip = random.choice(tips)

    bg_colors = [
        "lightpink", "skyblue", "lightgreen", "lavender",
        "lightyellow", "plum", "coral", "bisque", "aquamarine",
        "mistyrose", "honeydew", "lavenderblush", "oldlace"
    ]
    bg = random.choice(bg_colors)

    tk.Label(
        window,
        text=tip,
        bg=bg,
        font=("SimHei", 16),  # 手机端建议用 SimHei 等通用字体
        width=30,
        height=3
    ).pack()

    window.attributes("-topmost", True)

    # 绑定 ESC 键退出所有弹窗
    def on_esc(event):
        for win in all_windows:
            win.destroy()

    window.bind("<Escape>", on_esc)

    window.mainloop()


def generate_heart_points(num_points, scale=80):
    # 自动获取屏幕中心作为偏移
    root = tk.Tk()
    offset_x = root.winfo_screenwidth() / 2
    offset_y = root.winfo_screenheight() / 2
    root.destroy()  # 立即销毁临时窗口，避免残留
    points = []
    for i in range(num_points):
        t = i * 2 * math.pi / num_points  # 均匀分布角度
        # 心形曲线参数方程
        x = 16 * math.pow(math.sin(t), 3)
        y = 13 * math.cos(t) - 5 * math.cos(2 * t) - 2 * math.cos(3 * t) - math.cos(4 * t)
        # 缩放并偏移到屏幕中心
        points.append((x * scale + offset_x, -y * scale + offset_y))
    return points


num_windows = 200  # 定义窗口总数
heart_points = generate_heart_points(num_windows, scale=30)  # 生成对应数量的点
# 启动线程
for i in range(num_windows):
    x, y = heart_points[i]
    t = threading.Thread(target=show_warm_tip, args=(x, y))
    time.sleep(0.08)  # 控制创建速度，避免系统卡顿
    t.start()